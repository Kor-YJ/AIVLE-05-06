<!DOCTYPE html>
<!-- 길찾기 검색 페이지 -->
<!-- {% load static %} -->
<html lang="ko">
<head>
    <title> KIOSK </title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="/static/style.css">
    <script src="/static/hangul.js" type="text/javascript"></script>
    <script src="/static/keyboard.js" type="text/javascript"></script>
    <script src="/static/auth.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        .map_view .coodi_list li {
            display: block;
            background: url(/images/fl.png) no-repeat center bottom;
            width: 37px;
            height: 47px;
            line-height: 52px;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            color: #344873;
            margin-top: -47px;
            margin-left: -18.5px;
        }
        .coordi1 {
            position: absolute;
            top: 31%;
            left: 48%;
        }
        .floor_detail {
            background: url('/images/bg_floor_detail.gif') repeat 0 0;
            padding: 30px 23px 40px 30px;
            width: 100%;
            height: 603px;
            width: 250px;
            position: absolute;
            top: 175.44px;
            right: 0;
        }
        .floor_map {
            display: inline-block;
        }

        .map_view .coodi_list li.fl_on {
            background: url('/images/fl_on.png') no-repeat center bottom;
            width: 37px;
            height: 47px;
            line-height: 27px;
            z-index: 2;
        }

        .map_view .coodi_list li span {
            display: none;
        }

        .map_view .coodi_list li.fl_on span {
            display: block;
        }
    </style>
</head>
<body>
    {% include 'header.html' %}
    <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
        <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
        <label class="btn btn-outline-primary" for="btnradio1">Radio 1</label>
      
        <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
        <label class="btn btn-outline-primary" for="btnradio2">Radio 2</label>
      
        <input type="radio" class="btn-check" name="btnradio" id="btnradio3" autocomplete="off">
        <label class="btn btn-outline-primary" for="btnradio3">Radio 3</label>
    </div>
    <div>
        <div class='floor_map'>
            <div class='map_view'>
                <img src="{{ floor_map_image.floor_image }}" id='floor-map-image'alt="Floor Map Image">
                <ol class="coodi_list">
                    <li class="coordi1"><span>1<strong>영상의학과<br>- 일반,흉부촬영<br>- 골밀도검사<br>- CT</strong></span></li>
                </ol>         
            </div>
            <div class='facility_info'>

            </div>
        </div>
        <div class='floor_detail'>
            <ol>
                <li id="num_1">
                    <span class="num">1.</span>
                    <a id="navi_1179" href="#none" onclick="openMark( this, 1 );">영상의학과<br>- 일반,흉부촬영<br>- 골밀도검사<br>- CT</a>
                </li>
            </ol>
        </div>
    </div>
    <div class="keyboard-container">
        <div class="nav-find">
            <p id="nav-find-text">검색을 원하시는 장소를 입력해주세요</p>
            <input type="text" id="nav-input" placeholder="검색을 원하시는 장소를 입력해주세요" />
        </div>
    </div>
    <div class="btn-wrap">
        <button type="button" id="nav-btn-find" onclick="moveNav()">검 색</button>
    </div>
    <div id="keyboard-div"></div>
    <footer role="contentinfo" onclick="moveChat()">
        <div class="footer_wrap">
            <img src="/images/bot_image.png" id="bot_img"><div class="footer_block">저를 누르면 음성으로 대화 가능해요<br>무엇이든 물어보세요!</div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
<script>
    function moveNav(){//검색 장소명 전달 할 것
        location.href = "navigate.html";
    }
    function moveChat(){
        location.href = "chat.html";
    }
    function openMark(element, num) {
        // 모든 li 요소에서 fl_on 클래스 제거
        const allCoords = document.querySelectorAll('.map_view .coodi_list li');
        allCoords.forEach(coord => {
            coord.classList.remove('fl_on');
        });

        // 해당 num에 맞는 li 요소에 fl_on 클래스 추가
        const targetCoord = document.querySelector(`.coordi${num}`);
        if (targetCoord) {
            targetCoord.classList.add('fl_on');
        }
    }
    document.addEventListener('DOMContentLoaded', function() {
        const radioButtons = document.querySelectorAll('input[name="btnradio"]');

        radioButtons.forEach(radio => {
            radio.addEventListener('change', function() {
                const selectedValue = this.id.replace('btnradio', '');
                
                // GET 요청을 보낼 URL 생성
                const url = `https://111c-14-36-58-174.ngrok-free.app/departments/floor-map/${selectedValue}/`;

                alert(url);
                fetch(url)
                    .then(response => response.json())
                    .then(data => {
                        console.log(data);  
                        if (data) {
                            const imageElement = document.getElementById('floor-map-image');
                            imageElement.src = data.floor_image;
                        } else {
                            alert('Error: ' + data.error);
                            alert('11')
                        }
                    })
                    .catch(error => {
                        console.error('There was a problem with the fetch operation:', error);
                    });
            });
        });
    });

</script>
</html>
